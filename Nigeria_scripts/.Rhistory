itn_split <- split(itn, itn$year)
LGA <- list(LGA)
join <- map2(LGA, itn_split, left_join)
} else {
join <- left_join(LGA, itn)
}
}
for (i in 1:length(files)){
itn[[i]] <- read.csv(files[i]) %>%
mutate(coverage = rowMeans(dplyr::select(.,ends_with('ITN_use')),na.rm = TRUE ))
if(nrow(itn) > 774) {
itn_split <- split(itn, itn$year)
LGA <- list(LGA)
join <- map2(LGA, itn_split, left_join)
} else {
join <- left_join(LGA, itn)
}
}
for (i in 1:length(files)){
itn[[i]] <- read.csv(paste0(file_path,"/",files[i])) %>%
mutate(coverage = rowMeans(dplyr::select(.,ends_with('ITN_use')),na.rm = TRUE ))
if(nrow(itn) > 774) {
itn_split <- split(itn, itn$year)
LGA <- list(LGA)
join <- map2(LGA, itn_split, left_join)
} else {
join <- left_join(LGA, itn)
}
}
for (i in 1:length(files)){
itn[[i]] <- read.csv(paste0(file_path,"/",files[i])) %>%
mutate(coverage = rowMeans(dplyr::select(.,ends_with('ITN_use')),na.rm = TRUE ))
}
for (i in 1:length(files)){
itn[[i]] <- read.csv(paste0(file_path,"/",files[i])) #%>%
#mutate(coverage = rowMeans(dplyr::select(.,ends_with('ITN_use')),na.rm = TRUE ))
}
for (i in 1:length(files)){
itn[[i]] <- read.csv(paste0(file_path,"/",files[i])) %>%
mutate(coverage = rowMeans(dplyr::select(.,ends_with('ITN_use')),na.rm = TRUE ))
}
itn <- list()
for (i in 1:length(files)){
itn[[i]] <- read.csv(paste0(file_path,"/",files[i])) %>%
mutate(coverage = rowMeans(dplyr::select(.,ends_with('ITN_use')),na.rm = TRUE ))
}
View(itn)
files <- list.files(path = file_path, pattern="ITN.*csv")
itn <- list()
for (i in 1:length(files)){
itn[[i]] <- read.csv(paste0(file_path,"/",files[i])) %>%
mutate(coverage = rowMeans(dplyr::select(.,ends_with('ITN_use')),na.rm = TRUE ))
if(nrow(itn[[i]]) > 774) {
itn_split[[i]] <- split(itn[[i]], itn[[i]]$year)
LGA <- list(LGA)
join <- map2(LGA, itn_split[[i]], left_join)
} else {
join[[i]] <- left_join(LGA, itn[[i]])
}
}
files <- list.files(path = file_path, pattern="ITN.*csv")
itn <- list()
join <- list()
for (i in 1:length(files)){
itn[[i]] <- read.csv(paste0(file_path,"/",files[i])) %>%
mutate(coverage = rowMeans(dplyr::select(.,ends_with('ITN_use')),na.rm = TRUE ))
if(nrow(itn[[i]]) > 774) {
itn_split[[i]] <- split(itn[[i]], itn[[i]]$year)
LGA <- list(LGA)
join <- map2(LGA, itn_split[[i]], left_join)
} else {
join[[i]] <- left_join(LGA, itn[[i]])
}
}
itn <- list()
join <- list()
itn_split <- list()
for (i in 1:length(files)){
itn[[i]] <- read.csv(paste0(file_path,"/",files[i])) %>%
mutate(coverage = rowMeans(dplyr::select(.,ends_with('ITN_use')),na.rm = TRUE ))
if(nrow(itn[[i]]) > 774) {
itn_split[[i]] <- split(itn[[i]], itn[[i]]$year)
LGA <- list(LGA)
join <- map2(LGA, itn_split[[i]], left_join)
} else {
join[[i]] <- left_join(LGA, itn[[i]])
}
}
rm(list=ls())
setwd("C:/Users/ido0493/Box/NU-malaria-team/data/nigeria_dhs/data_analysis")
#setwd("~/Box/NU-malaria-team/data/nigeria_dhs/data_analysis")
## Reading in the necessary libraries
x <- c("tidyverse", "survey", "haven", "ggplot2", "purrr", "summarytools", "stringr", "sp", "rgdal", "raster",
"lubridate", "RColorBrewer","sf", "shinyjs", "tmap", "knitr", "labelled", "plotrix", "arules", "foreign",
"fuzzyjoin", "splitstackshape")
lapply(x, library, character.only = TRUE) #applying the library function to packages
source("src/maps/map_fun.R")
# read in LGA shape file
LGA <- clean_LGA("data/Nigeria_LGAs_shapefile_191016", "bin/names/LGA_shp_pop_names.csv")
#state <- LGA%>%  dplyr::select(State, LGA)
file_path <- "C:/Users/ido0493/Box/NU-malaria-team/projects/hbhi_nigeria/simulation_inputs/projection_csvs/projection_v2"
#path <- "C:/Users/ido0493/Box/NU-malaria-team/projects/hbhi_nigeria/simulation_output/2020_to_2025_v6"
# SMC
# smc <- read.csv(paste0(path, "/smc_scen2_80.csv"))
# head(smc)
# summary(smc$year)
#
# smc_2 <- smc %>% mutate(overall_coverage = coverage_high_access* 0.5 + coverage_low_access* 0.5) %>%
#   group_by(LGA, year) %>%
#   summarise(coverage = mean(overall_coverage)) %>%
#   ungroup(LGA) %>%
#   mutate(LGA = trimws(LGA), LGA = case_when(LGA == "kiyawa"~ "Kiyawa", LGA == "kaita" ~"Kaita", TRUE ~ LGA),
#          LGA = str_replace_all(LGA, "/", "-")) #%>%
#   #dplyr::select(-c(LGA))
#
# head(smc_2)
#
# smc_split <- split(smc_2, smc_2$year)
#
#
# LGAshp <- list(LGAshp_sf_2)
#
# join<- map2(LGAshp,smc_split,left_join)
# # CM
# cm <- read.csv(paste0(path,"/cm_scen3_v3.csv")) %>% mutate(LGA = trimws(LGA), LGA = str_replace_all(LGA, "/", "-")) #%>%  dplyr::select(-c(State))
# head(cm)
#
# cm_split <- split(cm, cm$year)
# #
# LGAshp <- list(LGAshp_sf_2)
#
# # join <- left_join(LGAshp_sf_2, cm, by = "LGA")
# # join <- list(join)
#
# join <- map2(LGAshp, cm_split, left_join)
# ITN
files <- list.files(path = file_path, pattern="ITN.*csv")
itn <- list()
join <- list()
itn_split <- list()
for (i in 1:length(files)){
itn[[i]] <- read.csv(paste0(file_path,"/",files[i])) %>%
mutate(coverage = rowMeans(dplyr::select(.,ends_with('ITN_use')),na.rm = TRUE ))
if(nrow(itn[[i]]) > 774) {
itn_split[[i]] <- split(itn[[i]], itn[[i]]$year)
LGA <- list(LGA)
join <- map2(LGA, itn_split[[i]], left_join)
} else {
join[[i]] <- left_join(LGA, itn[[i]])
}
}
View(itn_split)
View(itn_split)
files <- list.files(path = file_path, pattern="ITN.*csv")
files[2:6]
files <- list.files(path = file_path, pattern="ITN.*csv")
files <- files[2:6]
itn <- list()
join <- list()
itn_split <- list()
for (i in 1:length(files)){
itn[[i]] <- read.csv(paste0(file_path,"/",files[i])) %>%
mutate(coverage = rowMeans(dplyr::select(.,ends_with('ITN_use')),na.rm = TRUE ))
if(nrow(itn[[i]]) > 774) {
itn_split[[i]] <- split(itn[[i]], itn[[i]]$year)
LGA <- list(LGA)
join <- map2(LGA, itn_split[[i]], left_join)
} else {
join[[i]] <- left_join(LGA, itn[[i]])
}
}
View(itn_split)
View(itn_split)
itn_split[[1]]
View(LGA)
View(itn_split)
join <- map2(LGA, itn_split[[1]], left_join)
View(itn_split)
for (i in 1:length(files)){
itn[[i]] <- read.csv(paste0(file_path,"/",files[i])) %>%
mutate(coverage = rowMeans(dplyr::select(.,ends_with('ITN_use')),na.rm = TRUE ))
if(nrow(itn[[i]]) > 774) {
itn_split[[i]] <- split(itn[[i]], itn[[i]]$year)
LGA <- list(LGA)
join <- map2(LGA, itn_split[[i]], left_join)
} else {
join[[i]] <- left_join(LGA, itn[[i]])
}
}
rm(list=ls())
setwd("C:/Users/ido0493/Box/NU-malaria-team/data/nigeria_dhs/data_analysis")
#setwd("~/Box/NU-malaria-team/data/nigeria_dhs/data_analysis")
## Reading in the necessary libraries
x <- c("tidyverse", "survey", "haven", "ggplot2", "purrr", "summarytools", "stringr", "sp", "rgdal", "raster",
"lubridate", "RColorBrewer","sf", "shinyjs", "tmap", "knitr", "labelled", "plotrix", "arules", "foreign",
"fuzzyjoin", "splitstackshape")
lapply(x, library, character.only = TRUE) #applying the library function to packages
source("src/maps/map_fun.R")
# read in LGA shape file
LGA <- clean_LGA("data/Nigeria_LGAs_shapefile_191016", "bin/names/LGA_shp_pop_names.csv")
#state <- LGA%>%  dplyr::select(State, LGA)
file_path <- "C:/Users/ido0493/Box/NU-malaria-team/projects/hbhi_nigeria/simulation_inputs/projection_csvs/projection_v2"
#path <- "C:/Users/ido0493/Box/NU-malaria-team/projects/hbhi_nigeria/simulation_output/2020_to_2025_v6"
# SMC
# smc <- read.csv(paste0(path, "/smc_scen2_80.csv"))
# head(smc)
# summary(smc$year)
#
# smc_2 <- smc %>% mutate(overall_coverage = coverage_high_access* 0.5 + coverage_low_access* 0.5) %>%
#   group_by(LGA, year) %>%
#   summarise(coverage = mean(overall_coverage)) %>%
#   ungroup(LGA) %>%
#   mutate(LGA = trimws(LGA), LGA = case_when(LGA == "kiyawa"~ "Kiyawa", LGA == "kaita" ~"Kaita", TRUE ~ LGA),
#          LGA = str_replace_all(LGA, "/", "-")) #%>%
#   #dplyr::select(-c(LGA))
#
# head(smc_2)
#
# smc_split <- split(smc_2, smc_2$year)
#
#
# LGAshp <- list(LGAshp_sf_2)
#
# join<- map2(LGAshp,smc_split,left_join)
# # CM
# cm <- read.csv(paste0(path,"/cm_scen3_v3.csv")) %>% mutate(LGA = trimws(LGA), LGA = str_replace_all(LGA, "/", "-")) #%>%  dplyr::select(-c(State))
# head(cm)
#
# cm_split <- split(cm, cm$year)
# #
# LGAshp <- list(LGAshp_sf_2)
#
# # join <- left_join(LGAshp_sf_2, cm, by = "LGA")
# # join <- list(join)
#
# join <- map2(LGAshp, cm_split, left_join)
# ITN
files <- list.files(path = file_path, pattern="ITN.*csv")
files <- files[2:6]
itn <- list()
join <- list()
for (i in 1:length(files)){
itn[[i]] <- read.csv(paste0(file_path,"/",files[i])) %>%
mutate(coverage = rowMeans(dplyr::select(.,ends_with('ITN_use')),na.rm = TRUE ))
if(nrow(itn[[i]]) > 774) {
itn_split[[i]] <- split(itn[[i]], itn[[i]]$year)
LGA <- list(LGA)
join <- map2(LGA, itn_split[[i]], left_join)
} else {
join[[i]] <- left_join(LGA, itn[[i]])
}
}
itn <- read.csv(paste0(file_path, "/ITN_scen3_80_v3.csv")) %>%
mutate(coverage = rowMeans(dplyr::select(.,ends_with('ITN_use')),na.rm = TRUE ))
head(itn)
if(nrow(itn) > 774) {
itn_split <- split(itn, itn$year)
LGA <- list(LGA)
join <- map2(LGA, itn_split, left_join)
} else {
join <- left_join(LGA, itn)
}
rm(list=ls())
setwd("C:/Users/ido0493/Box/NU-malaria-team/data/nigeria_dhs/data_analysis")
#setwd("~/Box/NU-malaria-team/data/nigeria_dhs/data_analysis")
## Reading in the necessary libraries
x <- c("tidyverse", "survey", "haven", "ggplot2", "purrr", "summarytools", "stringr", "sp", "rgdal", "raster",
"lubridate", "RColorBrewer","sf", "shinyjs", "tmap", "knitr", "labelled", "plotrix", "arules", "foreign",
"fuzzyjoin", "splitstackshape")
lapply(x, library, character.only = TRUE) #applying the library function to packages
source("src/maps/map_fun.R")
# read in LGA shape file
LGA <- clean_LGA("data/Nigeria_LGAs_shapefile_191016", "bin/names/LGA_shp_pop_names.csv")
#state <- LGA%>%  dplyr::select(State, LGA)
file_path <- "C:/Users/ido0493/Box/NU-malaria-team/projects/hbhi_nigeria/simulation_inputs/projection_csvs/projection_v2"
#path <- "C:/Users/ido0493/Box/NU-malaria-team/projects/hbhi_nigeria/simulation_output/2020_to_2025_v6"
# SMC
# smc <- read.csv(paste0(path, "/smc_scen2_80.csv"))
# head(smc)
# summary(smc$year)
#
# smc_2 <- smc %>% mutate(overall_coverage = coverage_high_access* 0.5 + coverage_low_access* 0.5) %>%
#   group_by(LGA, year) %>%
#   summarise(coverage = mean(overall_coverage)) %>%
#   ungroup(LGA) %>%
#   mutate(LGA = trimws(LGA), LGA = case_when(LGA == "kiyawa"~ "Kiyawa", LGA == "kaita" ~"Kaita", TRUE ~ LGA),
#          LGA = str_replace_all(LGA, "/", "-")) #%>%
#   #dplyr::select(-c(LGA))
#
# head(smc_2)
#
# smc_split <- split(smc_2, smc_2$year)
#
#
# LGAshp <- list(LGAshp_sf_2)
#
# join<- map2(LGAshp,smc_split,left_join)
# # CM
# cm <- read.csv(paste0(path,"/cm_scen3_v3.csv")) %>% mutate(LGA = trimws(LGA), LGA = str_replace_all(LGA, "/", "-")) #%>%  dplyr::select(-c(State))
# head(cm)
#
# cm_split <- split(cm, cm$year)
# #
# LGAshp <- list(LGAshp_sf_2)
#
# # join <- left_join(LGAshp_sf_2, cm, by = "LGA")
# # join <- list(join)
#
# join <- map2(LGAshp, cm_split, left_join)
# ITN
itn <- read.csv(paste0(file_path, "/ITN_scen3_80_v3.csv")) %>%
mutate(coverage = rowMeans(dplyr::select(.,ends_with('ITN_use')),na.rm = TRUE ))
head(itn)
if(nrow(itn) > 774) {
itn_split <- split(itn, itn$year)
LGA <- list(LGA)
join <- map2(LGA, itn_split, left_join)
} else {
join <- left_join(LGA, itn)
}
View(itn_split)
map_val <- list("coverage")
var <- list("itn")
maps <- pmap(list(join, map_val, var), map_fun)
arrange_maps <- do.call(tmap_arrange, maps)
arrange_maps
file_path <- "C:/Users/ido0493/Box/NU-malaria-team/projects/hbhi_nigeria/simulation_inputs/projection_csvs/projection_v2"
rm(list=ls())
file_path <- "C:/Users/ido0493/Box/NU-malaria-team/projects/hbhi_nigeria/simulation_inputs/projection_csvs/projection_v2"
cm <- read.csv(paste0(file_path, "/HS_placeholder.csv"))
head(cm)
cm <- read.csv(paste0(file_path, "/HS_placeholder.csv")) %>%
mutate_at(vars(ends_with("coverage")| ends_with("cases"), funs(., +0.10)))
cm <- read.csv(paste0(file_path, "/HS_placeholder.csv")) %>%
mutate_at(vars(ends_with("coverage")| ends_with("cases"), funs(. +0.10)))
cm <- read.csv(paste0(file_path, "/HS_placeholder.csv")) %>%
mutate_at(vars(ends_with("coverage"), list(~. +0.10)))
cm <- read.csv(paste0(file_path, "/HS_placeholder.csv")) %>%
mutate_at(vars(ends_with("coverage")), list(~. +0.10))
cm <- read.csv(paste0(file_path, "/HS_placeholder.csv")) %>%
mutate_at(vars(ends_with("coverage")+ ends_with("cases")), list(~. +0.10))
cm <- read.csv(paste0(file_path, "/HS_placeholder.csv")) %>%
mutate_at(vars(ends_with("coverage")| ends_with("cases")), list(~. +0.10))
head(cm)
cm <- read.csv(paste0(file_path, "/HS_placeholder.csv"))
cm
cm <- read.csv(paste0(file_path, "/HS_placeholder.csv")) %>%
mutate_at(vars(ends_with("coverage")| ends_with("cases")), list(~. +0.10))
head(cm)
write.csv(cm, paste0(path, "cm_scen2_10_v3.csv"))
write.csv(cm, paste0(file_path, "cm_scen2_10_v3.csv"))
write.csv(cm, paste0(file_path, "/cm_scen2_10_v3.csv"))
cm <- read.csv(paste0(file_path, "/HS_placeholder.csv")) %>%
mutate_at(vars(ends_with("coverage")| ends_with("cases")), list(~. +0.20))
head(cm)
write.csv(cm, paste0(file_path, "/cm_scen2_20_v3.csv"))
cm <- read.csv(paste0(file_path, "/HS_placeholder.csv")) %>%
mutate_at(vars(ends_with("coverage")| ends_with("cases")), list(~. +0.30))
head(cm)
write.csv(cm, paste0(file_path, "/cm_scen2_30_v3.csv"))
itn <- read.csv(paste0(file_path, "/itn_scenario1.csv"))
head(itn)
itn_cc <- read.csv(paste0(file_path, "/itn_scenario1.csv"))
itn <- read.csv(paste0(file_path, "/itn_scenario1.csv")) %>%
mutate_at(vars(ends_with("ITN_use")), list(~. +0.10))
head(itn)
head(itn_cc)
write.csv(itn, paste0(file_path, "/ITN_scen2_10_v3.csv"))
itn <- read.csv(paste0(file_path, "/itn_scenario1.csv")) %>%
mutate_at(vars(ends_with("ITN_use")), list(~. +0.20))
head(itn)
head(itn_cc)
write.csv(itn, paste0(file_path, "/ITN_scen2_20_v3.csv"))
itn <- read.csv(paste0(file_path, "/itn_scenario1.csv")) %>%
mutate_at(vars(ends_with("ITN_use")), list(~. +0.30))
head(itn)
head(itn_cc)
write.csv(itn, paste0(file_path, "/ITN_scen2_30_v3.csv"))
rm(list=ls())
setwd("C:/Users/ido0493/Box/NU-malaria-team/data/nigeria_dhs/data_analysis")
#setwd("~/Box/NU-malaria-team/data/nigeria_dhs/data_analysis")
## Reading in the necessary libraries
x <- c("tidyverse", "survey", "haven", "ggplot2", "purrr", "summarytools", "stringr", "sp", "rgdal", "raster",
"lubridate", "RColorBrewer","sf", "shinyjs", "tmap", "knitr", "labelled", "plotrix", "arules", "foreign",
"fuzzyjoin", "splitstackshape")
lapply(x, library, character.only = TRUE) #applying the library function to packages
source("src/maps/map_fun.R")
# read in LGA shape file
LGA <- clean_LGA("data/Nigeria_LGAs_shapefile_191016", "bin/names/LGA_shp_pop_names.csv")
#state <- LGA%>%  dplyr::select(State, LGA)
file_path <- "C:/Users/ido0493/Box/NU-malaria-team/projects/hbhi_nigeria/simulation_inputs/projection_csvs/2010_2020_LGA_intervention_files/ITN"
#path <- "C:/Users/ido0493/Box/NU-malaria-team/projects/hbhi_nigeria/simulation_output/2020_to_2025_v6"
# SMC
# smc <- read.csv(paste0(path, "/smc_scen2_80.csv"))
# head(smc)
# summary(smc$year)
#
# smc_2 <- smc %>% mutate(overall_coverage = coverage_high_access* 0.5 + coverage_low_access* 0.5) %>%
#   group_by(LGA, year) %>%
#   summarise(coverage = mean(overall_coverage)) %>%
#   ungroup(LGA) %>%
#   mutate(LGA = trimws(LGA), LGA = case_when(LGA == "kiyawa"~ "Kiyawa", LGA == "kaita" ~"Kaita", TRUE ~ LGA),
#          LGA = str_replace_all(LGA, "/", "-")) #%>%
#   #dplyr::select(-c(LGA))
#
# head(smc_2)
#
# smc_split <- split(smc_2, smc_2$year)
#
#
# LGAshp <- list(LGAshp_sf_2)
#
# join<- map2(LGAshp,smc_split,left_join)
# # CM
# cm <- read.csv(paste0(path,"/cm_scen3_v3.csv")) %>% mutate(LGA = trimws(LGA), LGA = str_replace_all(LGA, "/", "-")) #%>%  dplyr::select(-c(State))
# head(cm)
#
# cm_split <- split(cm, cm$year)
# #
# LGAshp <- list(LGAshp_sf_2)
#
# # join <- left_join(LGAshp_sf_2, cm, by = "LGA")
# # join <- list(join)
#
# join <- map2(LGAshp, cm_split, left_join)
# ITN
itn <- read.csv(paste0(file_path, "/ITN_by_LGA_v6.csv")) #%>%
#mutate(coverage = rowMeans(dplyr::select(.,ends_with('ITN_use')),na.rm = TRUE ))
head(itn)
if(nrow(itn) > 774) {
itn_split <- split(itn, itn$year)
LGA <- list(LGA)
join <- map2(LGA, itn_split, anti_join)
} else {
join <- left_join(LGA, itn)
}
View(join)
if(nrow(itn) > 774) {
itn_split <- split(itn, itn$year)
LGA <- list(LGA)
join <- map2(LGA, itn_split, left_join)
} else {
join <- left_join(LGA, itn)
}
rm(list=ls())
setwd("C:/Users/ido0493/Box/NU-malaria-team/data/nigeria_dhs/data_analysis")
#setwd("~/Box/NU-malaria-team/data/nigeria_dhs/data_analysis")
## Reading in the necessary libraries
x <- c("tidyverse", "survey", "haven", "ggplot2", "purrr", "summarytools", "stringr", "sp", "rgdal", "raster",
"lubridate", "RColorBrewer","sf", "shinyjs", "tmap", "knitr", "labelled", "plotrix", "arules", "foreign",
"fuzzyjoin", "splitstackshape")
lapply(x, library, character.only = TRUE) #applying the library function to packages
source("src/maps/map_fun.R")
# read in LGA shape file
LGA <- clean_LGA("data/Nigeria_LGAs_shapefile_191016", "bin/names/LGA_shp_pop_names.csv")
#state <- LGA%>%  dplyr::select(State, LGA)
file_path <- "C:/Users/ido0493/Box/NU-malaria-team/projects/hbhi_nigeria/simulation_inputs/projection_csvs/2010_2020_LGA_intervention_files/ITN"
#path <- "C:/Users/ido0493/Box/NU-malaria-team/projects/hbhi_nigeria/simulation_output/2020_to_2025_v6"
# SMC
# smc <- read.csv(paste0(path, "/smc_scen2_80.csv"))
# head(smc)
# summary(smc$year)
#
# smc_2 <- smc %>% mutate(overall_coverage = coverage_high_access* 0.5 + coverage_low_access* 0.5) %>%
#   group_by(LGA, year) %>%
#   summarise(coverage = mean(overall_coverage)) %>%
#   ungroup(LGA) %>%
#   mutate(LGA = trimws(LGA), LGA = case_when(LGA == "kiyawa"~ "Kiyawa", LGA == "kaita" ~"Kaita", TRUE ~ LGA),
#          LGA = str_replace_all(LGA, "/", "-")) #%>%
#   #dplyr::select(-c(LGA))
#
# head(smc_2)
#
# smc_split <- split(smc_2, smc_2$year)
#
#
# LGAshp <- list(LGAshp_sf_2)
#
# join<- map2(LGAshp,smc_split,left_join)
# # CM
# cm <- read.csv(paste0(path,"/cm_scen3_v3.csv")) %>% mutate(LGA = trimws(LGA), LGA = str_replace_all(LGA, "/", "-")) #%>%  dplyr::select(-c(State))
# head(cm)
#
# cm_split <- split(cm, cm$year)
# #
# LGAshp <- list(LGAshp_sf_2)
#
# # join <- left_join(LGAshp_sf_2, cm, by = "LGA")
# # join <- list(join)
#
# join <- map2(LGAshp, cm_split, left_join)
# ITN
itn <- read.csv(paste0(file_path, "/ITN_by_LGA_v6.csv")) #%>%
#mutate(coverage = rowMeans(dplyr::select(.,ends_with('ITN_use')),na.rm = TRUE ))
head(itn)
if(nrow(itn) > 774) {
itn_split <- split(itn, itn$year)
LGA <- list(LGA)
join <- map2(LGA, itn_split, left_join)
} else {
join <- left_join(LGA, itn)
}
View(join)
map_val <- list("U5_ITN_use")
var <- list("itn")
maps <- pmap(list(join, map_val, var), map_fun)
arrange_maps <- do.call(tmap_arrange, maps)
arrange_maps
subDir <- "results/LGA_maps/ITN"
dir.create(file.path(getwd(), subDir), showWarnings = FALSE)
tmap_save(tm =arrange_maps, filename = paste0(subDir,"/U5_ITN_2010_2018.pdf"), width=13, height=13, units ="in", asp=0,
paper ="A4r", useDingbats=FALSE)
